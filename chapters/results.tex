\chapter{Results}\label{chap:results}


\section{Introduction}  

In this chapter, we present the main results of this thesis. We will prove a theorem similar to parts (b) and (c) of Theorem \ref{thm:ermodel} using standard probabilistic arguments. 

\begin{theorem}\label{thm:main}
    Let $\mathcal{S} \sim \mathcal{S}(M, p)$, where $p = p(M)$ is a monotone decreasing function of $M$ and $\frac{1}{M} \in o(p(M))$. Then, 
\begin{enumerate}[label=(\alph*)]
    \item If $\lim_{M \to \infty} p(M) = 0$, then for every $K \in \N$,   
    \[\lim_{M \to \infty} \Pr[e(\mathcal{S}) > K] = \lim_{M \to \infty} \Pr[g(\mathcal{S}) > K] = \lim_{M \to \infty} \Pr[F(\mathcal{S}) > K] = 1.\]
    \item If $\lim_{M \to \infty} p(M) > 0$, then $e(\mathcal{S}), \; g(\mathcal{S})$ and $F(\mathcal{S})$ are bounded in probability, i.e., for every $\varepsilon > 0$, there exists $K_\varepsilon$ such that 
    \[ \Pr[e(\mathcal{S}) < K_\varepsilon] > 1 - \varepsilon, \quad  \Pr[g(\mathcal{S}) < K_\varepsilon] > 1- \varepsilon \quad \text{and} \quad \Pr[F(\mathcal{S}) < K_\varepsilon] > 1 - \varepsilon.\]
\end{enumerate}
Furthermore, there exists $K \in \NN$ such that
\begin{align*}
\lim_{p \to 0}\Pr\left[F(\mathcal{S}) \leq \frac{K}{p}\left(\log \frac{1}{p}\right)^3\right] &= \lim_{p \to 0}\Pr\left[g(\mathcal{S}) \leq \frac{K}{p}\left(\log \frac{1}{p}\right)^3\right]  
\\&= \lim_{p \to 0}\Pr\left[e(\mathcal{S}) \leq 3K\left(\log \frac{1}{p}\right)^3\right] = 1.
\end{align*}
\end{theorem}
We will also show that that this Theorem is \textit{stronger} than Theorem \ref{thm:ermodel}. The proof of part (b) of this theorem is based on Lemma \ref{lem:sumset}, which is a result on sums of random subsets of cyclic groups.  

\section{Lower Bound}\label{sec:results:lowerbound}

We first prove part (a) of Theorem \ref{thm:main}. We will show that, for each fixed number of generators $a$, there is a high probability that at least $a$ minimal generators are chosen as $p \to 0$.

\textbf{Proof. }
Fix $a \in \NN$ such that $a > 11$ and let $T = \{1, \ldots, \lfloor\frac{a}{p}\rfloor\}$. Since   $\frac{1}{M} \in o(p)$, we have that $\lfloor\frac{a}{p}\rfloor \leq M$ for large enough $M$. Consider the following events:
\begin{itemize}
    \item $E_1$: No generator selected is less than $\frac{1}{ap}$.  \par
    Let $X_1$ be the number of generators selected from $\{1,\ldots,\lfloor\frac{1}{ap}\rfloor\}$. Then 
    \begin{equation}\label{eq:lowerbound:e1}
    \Pr[\lnot E_1] = \Pr[X_1 > 0] \leq \EE[X_1] \leq p \cdot \frac{1}{ap} = \frac{1}{a}.
    \end{equation}

    \item $E_2:$ At most $\frac{3a}{2}$ generators are selected from $T$.\par 
    Let $X_2$ be the number of generators selected in $T$, then $X_2 \sim \mathrm{Bin}(\frac{a}{p}, p)$ and we can use the bound in Proposition \ref{ap:prop:rightbinomtail} with $r = \frac{3a}{2}$ to get that

    \[\Pr[\lnot E_2] = \Pr\left[X_2 > \frac{3a}{2}\right] \leq  \frac{\frac{3a}{2}(1 - p)}{(\frac{3a}{2} - a)^2} = \frac{\frac{3a}{2}(1 - p)}{(\frac{a}{2})^2}\leq \frac{6}{a}.\]

    Also, by the union bound and (\ref{eq:lowerbound:e1}),
    \begin{equation}\label{eq:lowerbound:e1ande2}
     \Pr[E_1\land E_2] \geq 1 - \frac{1}{a} - \frac{6}{a} = 1 - \frac{7}{a}.
    \end{equation}

    \item $E_3:$ At least $\frac{a}{2}$ generators are selected from $T$. \par 
    Similarly, we can use the bound for the left tail (Proposition \ref{ap:prop:leftbinomtail}) with $r = \frac{a}{2}$ to get that
    \begin{equation}\label{eq:lowerbound:e3}
        \Pr[ \lnot E_3] = \Pr\left[X_2 < \frac{a}{2}\right] \leq  \frac{(n - \frac{a}{2})p}{(np - \frac{a}{2})^2} = \frac{a - (\frac{a}{2})p}{(\frac{a}{2})^2} \leq \frac{4}{a}.
    \end{equation}
    \item $E_4:$ The generators selected from $T$ are all minimal.\par 
    Let $A_T = \{Y_{(1)}, Y_{(2)}, \ldots, Y_{(k)}\}$ be the generators selected in $T$ in order. Assume $E_1$ and $E_2$. We have that $E_1$ implies $Y_{(1)} \geq \frac{1}{ap}$ and $E_2$ implies $k \leq \frac{3a}{2}$. \par
    First we bound the probability that $b \in T$ is selected as a generator. Using conditional probability, we have that 
    \begin{align}
        \Pr[b \in \mathcal{A}_T|E_1 \land E_2] &= \frac{\Pr[(b \in \mathcal{A}_T)\land E_1 \land E_2]}{\Pr[E_1 \land E_2]} \\
        &\leq\frac{\Pr[b \in \mathcal{A}_T]}{\Pr[E_1 \land E_2]} = \frac{p}{1 - \frac{7}{a}}. \label{eq:lowerbound:inequality}
    \end{align}
    Now, if no multiple of $Y_{(1)}$ is selected in $T$, then $Y_{(2)}$ is minimal. Thus, $Y_{(2)}$ is minimal if $\langle y_1 \rangle \cap  \mathcal{A}_T = \{y_1\}$. Also, note that, since the generators are chosen independently,
    \[P[b \in \mathcal{A}_T] = P[b \in \mathcal{A}_T|Y_{(1)} = y_1] \quad \text{if} \quad  b > y_1.\]
    Since $y_1 \geq \frac{1}{ap}$, we have that \[|\langle y_1 \rangle \cap  \mathcal{A}_T| \leq |\langle y_1 \rangle \cap T| \leq a^2.\] Then, using the union bound and (\ref{eq:lowerbound:inequality}),
    \begin{align*}
        \Pr[Y_{(2)} \text{ is not minimal}|E_1\land E_2 \land Y_{(1)} = y_1]&\leq \sum_{b \in\langle y_1\rangle \cap T}\Pr[b \in \mathcal{A}_T|E_1 \land E_2 \land Y_{(1)} = y_1]\\ 
        &\leq \sum_{b \in\langle y_1\rangle \cap T} \frac{p}{1 - \frac{7}{a}} \leq \frac{pa^2}{1 - \frac{7}{a}}.
    \end{align*}
        
    If this bound is independent of $y_1$, we get that 
    \begin{equation}\label{eq:lowerbound:y2notminimal}
        \Pr[Y_{(2)} \text{ is not minimal}|E_1\land E_2] \leq \frac{pa^2}{1 - \frac{7}{a}}.
    \end{equation}
    Similarly, for $2 \leq t \leq k$ and fixed $Y_{(1)} = y_1, \ldots, Y_{(t - 1)} = y_{t - 1}$, $Y_{(t)}$ is minimal if $\langle y_1, \ldots, y_{t - 1}\rangle \cap \mathcal{A}_T = \{y_1, \ldots, y_{t - 1}\}$. To bound $|\langle y_1, \ldots, y_{t - 1}\rangle \cap \mathcal{A}_T|$, there are at most $a^2$ choices for each multiple of $y_i$, so there are at most $a^{2(t - 1)}$ such linear combinations and
    \[|\langle y_1, \ldots, y_{t - 1} \rangle \cap  \mathcal{A}_T| \leq |\langle y_1, \ldots, y_{t - 1} \rangle \cap T| \leq a^{2(t - 1)}.\]
    Also, 
    \[P[b \in \mathcal{A}_T] = P[b \in \mathcal{A}_T|Y_{(1)} = y_1\land \cdots \land Y_{(t - 1)} = y_{t - 1}] \quad \text{if} \quad  b > y_{t - 1} > \ldots > y_1,\]
    and so
    \[
        \Pr[b \in \mathcal{A}_T|E_1 \land E_2 \land Y_{(1)} = y_1 \land \cdots \land Y_{(t - 1)} = y_{t - 1}] \leq \frac{p}{1 - \frac{7}{a}}.
    \]
    Then, as in (\ref{eq:lowerbound:y2notminimal}), 
    \[\Pr[Y_{(t)} \text{ is not minimal}|E_1\land E_2] \leq \frac{pa^{2t}}{1 - \frac{7}{a}} .\]
    Therefore, we can use the union bound and $k \leq \frac{3a}{2}$ to conclude that
    \[\Pr[E_4|E_1 \land E_2] \geq 1 - \frac{p}{1 - \frac{7}{a}}\sum_{t = 1}^{\frac{3a}{2} - 1}a^{2(t - 1)} = 1 - o(1),\]
    since $a$ is constant and $p \to 0$ as $M  \to \infty$.
    Thus,  
    \begin{equation}\label{eq:lowerbound:e4}
        \Pr[E_4] = \Pr[E_4| E_1 \land E_2]\Pr[E_1\land E_2] \geq 1 - \frac{7}{a} - o(1).
    \end{equation}
\end{itemize}


Finally, note that by the union bound, (\ref{eq:lowerbound:e3}) and (\ref{eq:lowerbound:e4}),
\[\Pr[E_4 \land E_3] \geq 1 - \frac{11}{a} - o(1).\] 
This means that for $\varepsilon > 0$ and sufficiently large $a$ and $M$, the probability that at least $\frac{a}{2}$ minimal generators are selected is greater than $1 - \varepsilon$. Threfore, for every $K \in \NN$, 
\[\lim_{M \to \infty} \Pr[e(\mathcal{S}) > K] = 1.\]
Now, using Corollary \ref{cor:smgps:embedding_dim} and Proposition \ref{prop:smgps:frobgenus}, we have that
\[e(S) \leq m(S) \leq g(S) + 1 \leq F(S) + 1.\]
We conclude that, for every $K \in \NN$,
\[\lim_{M \to \infty} \Pr[g(\mathcal{S}) > K] = \lim_{M \to \infty} \Pr[F(\mathcal{S}) > K] = 1.\qed\]

\section{Upper bound}\label{sec:results:upperbound}
Before proving part (b) of the Theorem \ref{thm:main}, we will prove a lemma that shows that a cyclic group of prime order is covered by the sums of a random subset of logarithmic size almost always.
\begin{lemma}\label{lem:sumset}
    Let $q$ be a prime number and $\mathcal{A}$ be a random subset of $\mathbb{Z}_q$ of size $4\lfloor6\log_2 q\rfloor$. As $q$ tends to infinity, $2\lfloor6\log_2 q\rfloor \mathcal{A}$ covers $\mathbb{Z}_q$ almost always. 
\end{lemma}

\textbf{Proof. } Let $s \in \mathbb{N}$ such that $s\leq q$. Let $\mathcal{A}$ be a uniformly random subset of $\mathbb{Z}_q$ of size $s$, that is, 
\[\Pr(\mathcal{A}) = \frac{1}{\binom{q}{s}}.\]
For a given $z \in \mathbb{Z}_q$ and $k \in \mathbb{N}$ for which $k \leq s/2$, let 
\[N_z^k := \left\{K \subseteq \mathbb{Z}_q: |K| = k, \sum_{t \in K} t = z\right\}.\]
Note that $|N_z^k| = \frac{1}{q}{\binom{q}{k}}$, since $K \in N_0^k$ if and only if $K + k^{-1}z \in N_z^k$ for every $z \in \mathbb{Z}_q$.\par
For $K \in N_z^k$, let $E_K$ be the event that $K \subset\mathcal{A}$. Let $X_K$ be the indicator variable of $E_K$.
We define the random variable 
\[X_z = \sum_{K \in N_z^k} X_K.\]
Note that $X_z$ counts the number of sets of size $k$ which add up to $z$. We now find $\EE[X_z]$. Since the sum of every subset $K \subset S$ is in $\mathbb{Z}_q$,
\[\sum_{z \in Z_q} X_z = {\binom{s}{k}},\]
and so
\[\binom{s}{k} = \EE\left[\sum_{z \in Z_q} X_z\right] =  \sum_{z \in Z_q} \EE[X_z].\]\par
As in the argument for finding $|N_z^k|$, for every $z \in \mathbb{Z}_q$, 
\[\EE[X_0] = \sum_{K \in N_0^k}\EE[X_K] = \sum_{K \in N_0^k} \EE[X_{K + k^{-1}z}] = \sum_{K \in N_z^k} \EE[X_K] = \EE[X_z].\]
Therefore, we have that
\begin{equation}\label{eq:upperbound:expected}
E[X_z] = \frac{1}{q} {\binom{s}{k}}.
\end{equation}
Now, for $K, L \in N_z^k$, let $j \in \mathbb{N}$ such that $j \leq k$ and define
\[\Delta_j := \sum_{|K \cap L| = j} \Pr[E_K \land E_L].\]
\par 
If $|K \cap L| = j$,
\[\Pr[E_K \land E_L] = \frac{\binom{q - 2k + j}{s - 2k + j}}{\binom{q}{s}}.\]
\par
We can bound the number of events for which $|K \cap L| = j$. First we choose $K$ as any set in $N_z^k$ and then we choose the remaining $k- j$ elements as any subset of $\mathbb{Z}_q \setminus K$ with size $k - j$. Thus, 
\[\Delta_j \leq \frac{1}{q}\binom{q}{k}\binom{q - k}{k - j} \frac{\binom{q - 2k + j}{s - 2k + j}}{\binom{q}{s}}.\]
\par This implies that, using \ref{eq:upperbound:expected},
\begin{align*}
    \frac{\Delta_j}{\EE[X_z]^2} &\leq \frac{\binom{q}{k} \binom{q - k}{k - j}\binom{q - 2k + j}{s - 2k + j}}{\frac{1}{q} \binom{s}{k}\frac{1}{q} \binom{s}{k}q\binom{q}{s}} \\
    &= \frac{\frac{q!}{(q - k)!k!}\frac{(q - k)!}{(k - j)!(q - 2k + k)!}\frac{(q - 2k + j)!}{(s - 2k + j)!(q - s)!}}{\frac{1}{q}\binom{s}{k}\frac{s!}{(s - k)!k!}\frac{q!}{(q - s)!s!}} \\
    &= \frac{q\binom{s - k}{k - j}}{\binom{s}{k}}.
\end{align*}
Let $s = 4\lfloor 6 \log_2 q \rfloor$ and $k = 2\lfloor 6 \log_2 q \rfloor$. Using that $\binom{s - k}{k - j}$ is maximized at $k - j = \lfloor (s - k) / 2\rfloor$,
\begin{align*}
\frac{\Delta_j}{\EE[X_z]^2} \leq \frac{q \binom{2\lfloor 6 \log_2 q \rfloor}{\lfloor 6 \log_2 q \rfloor}}{\binom{4\lfloor 6 \log_2 q \rfloor}{2\lfloor 6 \log_2 q \rfloor}} \leq \frac{q}{\binom{2\lfloor 6 \log_2 q \rfloor }{ \lfloor 6 \log_2 q \rfloor}} \leq \frac{q}{2^{\lfloor 6 \log_2 q \rfloor}} \sim \frac{1}{q^5},
\end{align*}
since \(\binom{2\lfloor 6 \log_2 q \rfloor}{\lfloor 6 \log_2 q \rfloor}^2 \leq \binom{4\lfloor 6 \log_2 q \rfloor }{2\lfloor 6 \log_2 q \rfloor}\) (Proposition \ref{ap:prop:binom}).   \par
Hence, by (\ref{eq:probmet:deltainequality}) and Theorem \ref{thm:probmet:secondmoment:1},
\begin{align*}
\Pr[X_z = 0] \leq \frac{\EE[X_z] + \Delta}{\EE[X_z]^2} &= \frac{1}{E[X_z]} + \sum_{j = 0}^k \frac{\Delta_j}{\EE[X_z]^2} \\
&\leq \frac{1}{E[X_z]} + \frac{(k + 1)}{q^5} = \frac{1}{E[X_z]} + \frac{2\lfloor 6 \log_2 q\rfloor + 1}{q^5}.
\end{align*}
Therefore, by the union bound and since $q \to \infty$ as $p \to 0$,
\begin{align}
\Pr\left[\bigvee_{z \in \mathbb{Z}_q} X_z = 0\right] &\leq \frac{q}{\EE[X_z]} + \frac{2\lfloor 6 \log_2 q \rfloor + 1}{q^4}\\
 &= \frac{q^2}{\binom{4\lfloor 6 \log_2 q \rfloor}{2\lfloor 6 \log_2 q \rfloor}} + \frac{2\lfloor 6 \log_2 q \rfloor + 1}{q^4} \\
 &\leq \frac{q^2}{2^{2\lfloor 6 \log_2 q \rfloor}} + \frac{2\lfloor 6 \log_2 q \rfloor + 1}{q^4} \\
 &\sim \frac{1}{q^{10}} + \frac{6\log q}{q^4}= o(1).\label{eq:lemma:prob}
\end{align}
We conclude that, as $q \to \infty$, $X_z > 0$ for every $z \in \mathbb{Z}_q$ almost always. Thus, for every $z \in \mathbb{Z}_q$, there exists $K \in N_z^k$ such that $K \subset \mathcal{A}$ almost always. This means that $2\lfloor 6 \log_2 q \rfloor \mathcal{A}$ covers $\mathbb{Z}_q$ almost always. \qed

\subsection{Proof of the upper bound} 
\begin{lemma}\label{lem:upperbound}
    Let $\psi(x)$ be a function for which $x(\log x)^2 \in o(\psi(x))$ .Then
    \[\lim_{p \to 0}\Pr\left[F(\mathcal{S}) \leq \psi\left(\frac{1}{p}\right)\right] = 1.\] 
\end{lemma}

\par The proof of this theorem consists of several parts. The strategy is to prove that the Ápery set of a subsemigroup of $S$ is completed before step $\psi\left(\frac{1}{p}\right)$ with high probability, since $F(\mathcal{S})$ is less than the maximum element of this Ápery set. The proof has the following structure: 
\begin{enumerate}
\item First, we will find a step for which a prime $q$ is chosen with high probability ($E_1$). 
\item Then, in the spirit of Lemma \ref{lem:sumset} we will find a step such that a set $\mathcal{A}$ of $s$ elements which are different modulo $q$ are chosen with high probability ($E_2$). 
\item Finally, we will apply Lemma \ref{lem:sumset} to $\mathrm{Ap}(\langle \mathcal{A} \cup \{q\}\rangle, q)$.
\end{enumerate}
\textbf{Proof. }
\subsubsection*{Part 1} 
Consider the event $D_1$ that a prime $q$ is selected, such that
\[\frac{200}{p}\log \frac{4}{p} \leq q \leq \left(\frac{4}{p}\log \frac{1}{p}\right)\log\left(\frac{4}{p}\log \frac{1}{p}\right).\]
Then
\[\Pr[\lnot D_1] \leq (1 - p)^{\frac{1}{p}\left(4\log\frac{1}{p} - 200\right)} \leq e^{-\left(4\log\frac{1}{p} - 200\right)} \in  O(p^4).\]
\subsubsection*{Part 2}

Given $D_1$, let $D_2$ be the event that more than $24\log q$ generators are selected. 
    Let $X \sim \mathrm{Bin}(q, p)$. Since 
    \[q \leq \left(\frac{4}{p}\log \frac{1}{p}\right)\log\left(\frac{4}{p}\log \frac{1}{p}\right),\]
    then
    \[24\log q \leq 24\log \left(\frac{4}{p}\right)^4 \leq 100\log\frac{4}{p}.\]
    Also, since 
    \[q \geq \frac{200}{p}\log\frac{4}{p},\]
    then 
    \[\EE[X]  = qp \geq 200\log\frac{4}{p}.\]
    Remember Chernoff's bound: 
    \begin{equation}
        \Pr[X \leq \EE[X] - \lambda] \leq e^{-\frac{\lambda^2}{2\EE[X]}} 
    \end{equation}
    Thus, using $\lambda = \frac{\EE[X]}{2}$,
    \begin{equation}
        \Pr[\lnot D_2] \leq \Pr\left[X \leq \EE[X] - \frac{\EE[X]}{2}\right] = e^{-\frac{\EE[X]}{8}} \leq e^{-25\log \frac{4}{p}} \in O(p^{25}).
    \end{equation}


\subsubsection*{Part 3}

\par Finally, assume $D_1$ and $D_2$. Let $\mathcal{A}$ be the set of generators of chosen before $q$. Since the generators are chosen randomly and $|\mathcal{A}| \geq 24\log q$, we can apply Lemma \ref{lem:sumset} to $\ZZ_q \cong \mathrm{Ap}(\langle\mathcal{A}\cup\{q\}\rangle, q)$. Consider the event $D_3$ that $\mathrm{Ap}(\langle\mathcal{A}\cup\{q\}\rangle, q)$ will be completed before step \[ 12q\log q \in O\left(\frac{1}{p}\left(\log \frac{1}{p}\right)^3\right).\] 
Applying Lemma \ref{lem:sumset} (Equation \ref{eq:lemma:prob}), we have that
\begin{align*}
\Pr[\lnot D_3] &\leq \frac{1}{q^{10}} + \frac{6\log q}{q^4} \\
&\leq \frac{1}{\left(\frac{200}{p}\log \frac{4}{p}\right)^{10}}
+ \frac{6\log\left(\frac{4}{p}\right)^4}{\left(\frac{200}{p}\log\frac{4}{p}\right)^4} \in O(p^4).
\end{align*}
\par 

Thus, there exists $K > 0$ such that 

\[\lim_{p \to  0} \Pr\left[F(\langle\mathcal{A}\cup \{q\}\rangle) \leq \frac{K}{p}\left(\log \frac{1}{p}\right)^3\right] = 1.\]
Since $F(\mathcal{S}) \leq F(\langle \mathcal{A}\cup\{q\}\rangle)$, we conclude that
\[\lim_{p \to 0}\Pr\left[F(\mathcal{S}) \leq \frac{K}{p}\left(\log \frac{1}{p}\right)^3\right] = 1.\qed\]

Now, note that the expected value of the Frobenius number can be bounded by
\begin{align*}
\EE[F(\mathcal{S})] &= \EE[F(\mathcal{S}) | D_1 \land D_2 \land D_3] \Pr[D_1 \land D_2 \land D_3]
\\&+ \EE[F(\mathcal{S}) |\lnot(D_1 \land D_2 \land D_3)] \Pr[\lnot(D_1 \land D_2 \land D_3)] 
\\&\leq \EE[F(\mathcal{S}) | D_1 \land D_2 \land D_3] 
\\&+ \EE[F(\mathcal{S}) |\lnot(D_1 \land D_2 \land D_3)] \Pr[\lnot(D_1 \land D_2 \land D_3)]
\\&\leq \frac{K}{p}\left(\log \frac{1}{p}\right)^3 + \EE[F(\mathcal{S}) |\lnot(D_1 \land D_2 \land D_3)]O(p^4).
\end{align*}

Now,
\begin{align*}
    \EE[F(\mathcal{S}) |\lnot(D_1 \land D_2 \land D_3)] &\leq \EE[(\min\{(2n)^2|2n \text{ and } 2n + 1 \text{ are selected} \})]
    \\&= \sum_{n = 0}^\infty (2n)^2 (1 - p^2)^{n - 1}p^2
    \\&\leq p^2\sum_{n = 0}^\infty (2n)^2 e^{-p^2(n - 1)}
    \\&\leq p^2 \int_{0}^\infty (2x)^2 e^{-p^2(x - 1)}\;\mathrm{d}x
    \\&= \frac{8e^{p^2}}{p^4}.
\end{align*}
Therefore, 
\[\EE[F(\mathcal{S})] \leq \frac{K}{p}\left(\log \frac{1}{p}\right)^3 + C,\]
for some constants $K$ and $C$ that do not depend on $p$.
\begin{corollary}
    \[\lim_{p \to 0}\Pr\left[g(\mathcal{S}) \leq \frac{K}{p}\left(\log \frac{1}{p}\right)^3\right] = 1.\]
\end{corollary}
\textbf{Proof. } Use Proposition \ref{prop:smgps:frobgenus}. \qed
\begin{corollary}
    \[\lim_{p \to 0}\Pr\left[e(\mathcal{S}) \leq 3K\left(\log \frac{1}{p}\right)^3\right] = 1.\]
\end{corollary}
\textbf{Proof. } Since
\[\lim_{p \to 0}\Pr\left[F(\mathcal{S}) \leq \frac{K}{p}\left(\log \frac{1}{p}\right)^3\right] = 1,\]
and the maximal element of the minimal generating set is at most $2F(\mathcal{S})$, the elements of the minimal generating set are chosen before step $\frac{2K}{p}\left(\log \frac{1}{p}\right)^3$ with high probability. Since 
\[\left|\mathcal{A}\cap\left\{1, \ldots, \left\lfloor\frac{2K}{p}\left(\log \frac{1}{p}\right)^3\right \rfloor\right\}\right| \sim \mathrm{Bin}\left(\left\lfloor\frac{2K}{p}\left(\log \frac{1}{p}\right)^3\right \rfloor, p\right),\]
 by the bound on the right tail of the binomial distribution (Proposition \ref{ap:prop:rightbinomtail}), we have that
\[\lim_{p \to 0}\Pr\left[e(\mathcal{S}) \leq 3K\left(\log \frac{1}{p}\right)^3\right] = 1.\]